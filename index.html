<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NSE Bulk Deals Filtered Demo</title>
  <style>
    body { font-family: system-ui, Segoe UI, Roboto, Arial; line-height: 1.4; margin: 1rem; background: #f7f9fc; color: #111; }
    main { max-width: 900px; margin: 0 auto; background: #fff; padding: 1rem 1.25rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,.05); }
    h1 { font-size: 1.3rem; margin-bottom: 1rem; text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: .4rem .6rem; border-bottom: 1px solid #eee; text-align: left; font-size: .9rem; }
    th { background: #eef2f6; }
    .note { font-size: .85rem; color: #666; margin-top: .6rem; text-align: center; }
    #status { margin-top: .5rem; text-align: center; color: #333; }
  </style>
</head>
<body>
  <main>
    <h1>NSE Bulk Deals Filtered (Only Buy or Only Sell)</h1>
    <div id="status">Loading sample data...</div>
    <table aria-describedby="status">
      <thead>
        <tr>
          <th>Date</th>
          <th>Symbol</th>
          <th>Security</th>
          <th>Client/Organization</th>
          <th>Buy/Sell</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody id="results_body"></tbody>
    </table>
    <p class="note">Demo sample data shown. Live NSE API access requires server proxy due to CORS restrictions.</p>
  </main>
<script>
  const sampleData = [
    {date: "2025-10-06", symbol: "RELIANCE", security: "Reliance Industries", client: "Org A", buySell: "buy", qty: 50000},
    {date: "2025-10-06", symbol: "INFY", security: "Infosys Ltd", client: "Org B", buySell: "sell", qty: 20000},
    {date: "2025-10-06", symbol: "TCS", security: "Tata Consultancy", client: "Org C", buySell: "buy", qty: 15000},
    {date: "2025-10-06", symbol: "TCS", security: "Tata Consultancy", client: "Org D", buySell: "sell", qty: 15000},
    {date: "2025-10-06", symbol: "HDFC", security: "HDFC Bank", client: "Org E", buySell: "buy", qty: 30000},
    {date: "2025-10-06", symbol: "HDFC", security: "HDFC Bank", client: "Org F", buySell: "buy", qty: 10000},
    {date: "2025-10-06", symbol: "ICICI", security: "ICICI Bank", client: "Org G", buySell: "sell", qty: 25000}
  ];

  function filterOnlyBuyOrOnlySell(data) {
    const groups = {};
    data.forEach(r => {
      const key = r.date + '||' + r.symbol;
      groups[key] = groups[key] || { buys: [], sells: [] };
      if(r.buySell.toLowerCase() === 'buy') groups[key].buys.push(r);
      else if(r.buySell.toLowerCase() === 'sell') groups[key].sells.push(r);
    });

    const filtered = [];
    Object.values(groups).forEach(g => {
      const onlyBuy = g.sells.length === 0 && g.buys.length > 0;
      const onlySell = g.buys.length === 0 && g.sells.length > 0;
      if(onlyBuy) filtered.push(...g.buys);
      else if(onlySell) filtered.push(...g.sells);
    });
    return filtered;
  }

  function renderTable(rows) {
    const tbody = document.getElementById('results_body');
    tbody.innerHTML = '';
    if(rows.length === 0){
      document.getElementById('status').textContent = 'No bulk deals found matching the criteria.';
      return;
    }
    rows.forEach(r => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${r.date}</td><td>${r.symbol}</td><td>${r.security}</td><td>${r.client}</td><td>${r.buySell}</td><td>${r.qty.toLocaleString()}</td>`;
      tbody.appendChild(tr);
    });
    document.getElementById('status').textContent = `Showing ${rows.length} bulk deals (only buy or only sell filtered).`;
  }

  function init() {
    const filteredData = filterOnlyBuyOrOnlySell(sampleData);
    renderTable(filteredData);
  }

  init();
</script>
</body>
</html>
